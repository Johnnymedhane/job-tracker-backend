CREATE DATABASE IF NOT EXISTS job_tracker;
USE job_tracker;

CREATE TABLE IF NOT EXISTS jobs (
  id BIGINT PRIMARY KEY,
  title VARCHAR(255) NOT NULL,
  company VARCHAR(255),
  description TEXT,
  connection VARCHAR(255),
  status VARCHAR(100),
  website VARCHAR(255),
  createdAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updatedAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);

CREATE TABLE IF NOT EXISTS mustHave (
  id BIGINT PRIMARY KEY,
  jobId BIGINT NOT NULL,
  requirement VARCHAR(255) NOT NULL,
  createdAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (jobId) REFERENCES jobs(id) ON DELETE CASCADE
);

CREATE TABLE IF NOT EXISTS niceToHave (
  id BIGINT PRIMARY KEY,
  jobId BIGINT NOT NULL,
  requirement VARCHAR(255) NOT NULL,
  rank TINYINT UNSIGNED NOT NULL DEFAULT 1,
  createdAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (jobId) REFERENCES jobs(id) ON DELETE CASCADE,
  CHECK (rank BETWEEN 1 AND 5)
);
